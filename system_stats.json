{
  "timestamp": "2025-09-25T21:21:29.466863",
  "feeds": {
    "total_feeds": 118,
    "active_feeds": 118,
    "healthy_feeds": 118,
    "top_sources": [
      {
        "domain": "theguardian.com",
        "count": 3586
      },
      {
        "domain": "nytimes.com",
        "count": 2373
      },
      {
        "domain": "cbssports.com",
        "count": 1901
      },
      {
        "domain": "go.com",
        "count": 1893
      },
      {
        "domain": "google.com",
        "count": 1848
      }
    ]
  },
  "articles": {
    "total_articles": 15583,
    "recent_24h": 1028,
    "status_counts": {
      "False": 15570,
      "True": 13
    },
    "top_sources": [
      {
        "domain": "theguardian.com",
        "count": 1200
      },
      {
        "domain": "google.com",
        "count": 876
      },
      {
        "domain": "cbssports.com",
        "count": 782
      },
      {
        "domain": "nytimes.com",
        "count": 674
      },
      {
        "domain": "go.com",
        "count": 660
      }
    ]
  },
  "chunks": {
    "total_chunks": 175913,
    "recent_24h": 5925,
    "processing_stages": {
      "complete": 175822,
      "needs_fts": 91
    },
    "avg_chunks_per_article": 11.65
  },
  "embeddings": {
    "embedded_chunks": 175913,
    "pending_embeddings": 0,
    "recent_24h": 5925,
    "vector_dimensions": 3072,
    "completion_rate": 100.0
  },
  "services": {
    "service_manager_running": false,
    "services": {
      "chunking": {
        "enabled": true,
        "interval": 30,
        "connectivity": true
      },
      "fts": {
        "enabled": true,
        "interval": 60,
        "connectivity": true
      },
      "embedding": {
        "enabled": true,
        "interval": 45,
        "connectivity": true
      }
    },
    "llm_connectivity": true
  },
  "llm_insights": "1) Главные проблемы\n- Отсутствует оркестрация: service_manager_running=False.\n- Аномалия со статусами статей: True=13 vs False=15570 (крайне низкая доля “успешных”).\n- Небольшой, но существующий хвост FTS: needs_fts=91.\n- Возможная регрессия в чанкинге за 24ч: 5925 чанков на 1028 статей ≈5.8 чанка/статью против среднего 11.65 (изменение качества входящих или настроек).\n- Сильная концентрация на нескольких доменах — риск зависимости/дубликатов.\n\n2) Наиболее критичные метрики\n- service_manager_running=False.\n- ARTICLES.status_counts: True=13 / 15583 (~0.08%).\n- CHUNKS.processing_stages.needs_fts=91 (как индикатор застревания шагов).\n- Падение recent chunks per article: ~5.8 vs 11.65.\n\n3) Что сделать в первую очередь\n- Поднять/перезапустить service manager, включить авто‑рестарт и heartbeat.\n- Диагностировать и исправить логику установки статуса статьи:\n  - Проверить пайплайн “ingest → parse → chunk → fts → embed → publish/ready”.\n  - Сравнить статьи с завершёнными шагами и статусом False; проверить дефолты/миграции БД.\n  - Прогнать backfill/repair, чтобы выставить корректный статус тем, у кого шаги завершены.\n- Очистить FTS‑хвост: вручную докатить 91 запись, убедиться, что новые не застревают.\n- Проверить недавние изменения конфигурации чанкинга (max_tokens/сплиттер); при необходимости откатить.\n- Проверить правила дедупликации и лимиты на источники, чтобы не забивать пайплайн повторяющимися материалами.\n\n4) Рекомендации для стабильности\n- Мониторинг и алерты:\n  - Heartbeat service manager.\n  - Доля статей со статусом True за 24ч ≥ заданного порога (например, 90%).\n  - Backlog’и по FTS/embeddings/очередям < порога.\n  - Время от ingestion до готовности (SLO).\n  - Аномалии chunks_per_article.\n- Оркестрация и отказоустойчивость: watchdog, автоперезапуск, healthchecks, единый оркестратор.\n- Прозрачная диагностика: логировать причину отказа на уровне статьи/шага, трассировка, версии конфигов.\n- Регулярные backfill/repair‑задачи для несогласованных статусов.\n- Управление источниками: квоты на домены, дедуп по URL/контенту, балансировка.\n- Контролируемые изменения конфигурации (фича‑флаги/канареечные деплойments) и интеграционные тесты на смену статуса."
}